------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\te48local\Dropbox\Coal Bonding\Code\Log\kentucky_data_compilation 3 Feb 2021.log
  log type:  text
 opened on:   3 Feb 2021, 14:27:32

. set more off

. 
. ************************************************************************************
. ************************************************************************************
. /*
> DO FILE NAME: kentucky_data_compilation.do
> DO FILE AUTHORS:  Tom Eisenberg
> SOURCE:  None
> 
> PURPOSE: Reads in and manipulates the Kentucky coal bonding data
> 
> DATE CREATED: 02/02/2021
> 
> NOTES: 
> 
> CHANGES:
> 
> */
. 
. *Files this do file uses
. ************************************************************************************
. ******* .dta files
. local kydata "$MASTER\Data\Bond Spreadsheets\Kentucky\Bonds_and_bond_activities_12032020.xlsx"

. 
. ** Import original Excel file - takes a while so better off using stata file to start
. 
. *import excel using "`kydata'", firstrow 
. 
. *save "$MASTER\Data\Bond Spreadsheets\Kentucky\kentucky_raw_stata.dta", replace
. 
. use "$MASTER\Data\Bond Spreadsheets\Kentucky\kentucky_raw_stata.dta", clear

. 
end of do-file

. help expand

. tab PERMIT_NUMBER
too many values
r(134);

. browse PERMIT_NUMBER

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. keep if PERMIT_NUMBER=="0070019"
(162,886 observations deleted)

. 
end of do-file

. browse

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. destring BOND_ISSUE_DATE, replace
BOND_ISSUE_DATE: contains nonnumeric characters; no replace

. 
end of do-file

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. gen bond_date = date(BOND_ISSUE_DATE, "MDY")

. 
end of do-file

. browse BOND_ISSUE_DATE bond_date

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. format bond_date %td

. 
end of do-file

. browse BOND_ISSUE_DATE bond_date

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. format BOND_ACTIVITY_DATE %td

. 
end of do-file

. browse BOND_ISSUE_DATE bond_date BOND_ACTIVITY_DATE

. do "C:\Users\TE48LO~1\AppData\Local\Temp\STD5070_000000.tmp"

. clear all

. 
. ** Set major file path
. 
. global MASTER "C:\Users\te48local\Dropbox\Coal Bonding"

. 
. ** Standard Header Stuff
. capture log close
